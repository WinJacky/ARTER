<HTML lang="en">
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
<META charset="utf-8">
    
<TITLE>Password Manager</TITLE>
    
<META content="width=device-width, initial-scale=1.0" name="viewport">
    
<META content="Password Manager" name="description">
    
<META content="Jeffery" name="author">
	
<LINK href="css/bootstrap.min.css" rel="stylesheet">
	
<LINK href="css/style.css" rel="stylesheet">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <!-- Fav and touch icons -->
    
<LINK href="favicon.ico" rel="shortcut icon">
    
<SCRIPT src="js/jquery.min.js" type="text/javascript"></SCRIPT>
	<SCRIPT src="js/bootstrap.min.js" type="text/javascript"></SCRIPT>
    
<STYLE>
    .footer {
        color: #777;
        text-align: center;
        padding: 30px 0;
        margin-top: 70px;
        border-top: 1px solid #e5e5e5;
        background-color: #f5f5f5;
        }
    </STYLE>

</HEAD>
<BODY style="color: rgb(102, 102, 102);">
<SCRIPT src="aes.js" type="text/javascript"></SCRIPT>
<SCRIPT src="sha512.js" type="text/javascript"></SCRIPT>
<SCRIPT src="pbkdf2.js" type="text/javascript"></SCRIPT>
<SCRIPT src="password.js" type="text/javascript"></SCRIPT>
<SCRIPT src="setlocalstorage.js" type="text/javascript"></SCRIPT>
<SCRIPT type="text/javascript">
if(typeof(Storage) == "undefined") {
        window.location.href="./sorry_for_old_browser_update_hint.html";
    }
</SCRIPT>
    
<DIV class="container theme-showcase" style="margin-top:-30px;">
        
<DIV class="page-header">
            
<H1>Password Manager</H1>
        
</DIV>
        
<P>Please Sign in:<BR>
</P>
        
<FORM>
            
<P>User Name: <INPUT id="user" name="user" type="text">
</P>
<BR>
            
<P>Password: <INPUT id="pwd" name="pwd" type="password">
</P>
<BR>
        
<INPUT class="btn btn-md btn-success" disabled id="chk" type="button" value="Wait">
</FORM>
        
<SPAN class="errorhint" id="nouser" style="display:none; color:Red">We don't have this user on file<BR>
</SPAN>
        <SPAN class="errorhint" id="pwderr" style="display:none; color:Red">Wrong Password<BR>
</SPAN>
        <SPAN class="errorhint" id="othererror" style="display:none; color:Red">Oops, our server run into some problems. Please refresh this page and try again.<BR>
</SPAN>
        
<HR>
        
<BUTTON class="btn btn-sm btn-default" onclick="window.location.href='signup.php';" type="button">Sign Up</BUTTON>&nbsp; <BUTTON class="btn btn-sm btn-warning" onclick="window.location.href='recovery.php';" type="button">Password Recovery</BUTTON>
    
<HR>
    
<DIV>Version 8.0 (<A href="https://github.com/zeruniverse/Password-Manager/releases">DOWNLOAD</A>)</DIV>
    
<DIV class="modal" id="usepin" role="dialog" tabindex="-1">
        
<DIV class="modal-dialog">
            
<DIV class="modal-content">
                
<DIV class="modal-header">
                    
<BUTTON aria-label="Close" class="close" data-dismiss="modal" onclick="delpinstore()" type="button"><SPAN aria-hidden="true">&times;</SPAN></BUTTON>
                    
<H4>Use PIN to login</H4>
                
</DIV>
                
<DIV class="modal-body">
                    
<FORM>
                        
<DIV class="form-group">
                            
<LABEL class="control-label" for="pin">PIN:</LABEL>
                            <INPUT class="form-control" id="pin" type="password">
                        
</DIV>
                    
</FORM>
                
</DIV>
                
<DIV class="modal-footer">
                    
<P id="pinerrorhint" style="display:none">PIN ERROR, try again.</P>
                    
<BUTTON class="btn btn-default" data-dismiss="modal" onclick="delpinstore()" type="button">Use username/password</BUTTON>
                    <BUTTON class="btn btn-primary" id="pinlogin" type="button">Login</BUTTON>
                
</DIV>
            
</DIV>
        
</DIV>
    
</DIV>
    
</DIV>

<SCRIPT type="text/javascript">
var JSsalt='iunin19dnu9ismcj9IUNuia,cne9e389]{}{}[]*@key';
var PWSalt='ncew8d7*(e8fyh2inc osd2)wefcsBIUsdfq2as;dqw[;[]]';
$(function(){
    if(getcookie('device')!="")
    {
        if(1==0) $("#usepin").modal("show");
        else{
            delpinstore();
        }
    }
    $("#pinlogin").click(function(){
        var pin;
        $("#pinerrorhint").hide();
        $("#pinlogin").attr("disabled", true);
		$("#pinlogin").html("Wait");
        pin=$("#pin").val();
        $.post("getpinpk.php",{user:getcookie('username'),device:getcookie('device'),sig:String(CryptoJS.SHA512(pin+localStorage.pinsalt))},function(msg){
            if(msg == '0') {$("#usepin").modal("hide");delpinstore();return;}
            if(msg == '1') {$("#pin").val('');$("#pinerrorhint").show();$("#pinlogin").attr("disabled", false);$("#pinlogin").html("Login"); return;}
            pwdsk=decryptchar(localStorage.en_login_sec,pin+msg);
            confkey=decryptchar(localStorage.en_login_conf,pin+msg)
            $.post("check.php",{pwd:String(CryptoJS.SHA512(pbkdf2_enc(pwdsk,JSsalt,500)+"2021012201163397880")),  user: getcookie('username')},function(msg){
                if(msg!=9) {$("#usepin").modal("hide");delpinstore();return;}
                setpwdstore(pwdsk,confkey,'ncew8d7*(e8fyh2inc osd2)wefcsBIUsdfq2as;dqw[;[]]');                
                window.location.href="./password.php";
            });
        });
    });
    $("#chk").click(function(){ 
        $("#chk").attr("disabled", true);
		$("#chk").attr("value", "Wait");
        function process(){
        var user = $("#user").val(); 
		var pwd = $("#pwd").val();
        
        var secretkey='';
        var confkey='';
		var login_sig=String(pbkdf2_enc(reducedinfo(pwd,'RSTUVWXYZabcdefgABCDEFGHIJKLMNOPQhijklmnopqrstuvwxyz0123456789*=+~-'),JSsalt,500));
        secretkey=login_sig;
        login_sig=pbkdf2_enc(login_sig,JSsalt,500);
        $.post("check.php",{pwd:String(CryptoJS.SHA512(login_sig+"2021012201163397880")),  user: user},function(msg){ 
        $(".errorhint").hide();
		if(msg==0){
			 	$("#nouser").show();
				$("#chk").attr("value", "Login");
				$("#chk").attr("disabled", false);
		}else
		if(msg==1){
			 	$("#pwderr").show();
				$("#chk").attr("value", "Login");
				$("#chk").attr("disabled", false);
		}else
		if(msg==4){
			 	$("#othererror").show();
				$("#chk").attr("value", "Login");
				$("#chk").attr("disabled", false);
		}else{
                confkey=pbkdf2_enc(String(CryptoJS.SHA512(pwd+secretkey)),JSsalt,500);
                setCookie("username",user);
                setpwdstore(secretkey,confkey,'ncew8d7*(e8fyh2inc osd2)wefcsBIUsdfq2as;dqw[;[]]');                
                window.location.href="./password.php";
		}
        });
        }
        setTimeout(process,50);
    }); 
}); 
</SCRIPT>

<FOOTER class="footer ">

<P>&copy;2015 Jeffery<BR>
<BR>ALL RIGHTS RESERVED</P>

</FOOTER>


</BODY>
</HTML>
